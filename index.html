<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ComfyUI Launcher</title>
  <link rel="stylesheet" href="renderer/styles.css">
</head>
<body>
  <!-- Icon Sprite (Lucide) -->
  <svg xmlns="http://www.w3.org/2000/svg" style="display:none">
    <symbol id="icon-settings" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"/>
      <circle cx="12" cy="12" r="3"/>
    </symbol>
    <symbol id="icon-arrow-left" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="m12 19-7-7 7-7"/>
      <path d="M19 12H5"/>
    </symbol>
    <symbol id="icon-plus" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M5 12h14"/>
      <path d="M12 5v14"/>
    </symbol>
  </svg>

  <!-- Instance List View -->
  <div id="view-list" class="view active">
    <div class="toolbar">
      <h2 data-i18n="list.title">Installations</h2>
      <div class="toolbar-actions">
        <button id="btn-settings" class="icon-btn" title="Settings"><svg width="18" height="18"><use href="#icon-settings"/></svg></button>
        <button id="btn-track" data-i18n="list.trackExisting">Track Existing</button>
        <button class="primary add-btn" id="btn-new"><svg width="14" height="14"><use href="#icon-plus"/></svg> <span data-i18n="list.newInstall">New Install</span></button>
      </div>
    </div>
    <div class="view-list-scroll">
      <div id="instance-list" class="instance-list"></div>
    </div>
    <div id="update-banner" class="update-banner" style="display:none"></div>
  </div>

  <!-- New Install View -->
  <div id="view-new" class="view">
    <div class="toolbar">
      <h2 data-i18n="newInstall.title">New Installation</h2>
      <button id="btn-new-back" class="back-btn"><svg width="14" height="14"><use href="#icon-arrow-left"/></svg> <span data-i18n="common.back">Back</span></button>
    </div>
    <div class="view-scroll">
      <div id="detected-gpu" class="detected-hardware"></div>

      <div class="field">
        <label for="inst-name" data-i18n="common.name">Name</label>
        <input type="text" id="inst-name" placeholder="e.g. ComfyUI Main">
      </div>

      <div class="field">
        <label for="source" data-i18n="newInstall.installMethod">Install Method</label>
        <select id="source" disabled><option>Loading…</option></select>
      </div>

      <div id="source-fields"></div>

      <div class="field">
        <label for="inst-path" data-i18n="newInstall.installLocation">Install Location</label>
        <div class="path-input">
          <input type="text" id="inst-path" placeholder="Loading…" readonly>
          <button id="btn-browse" type="button" data-i18n="common.browse">Browse…</button>
        </div>
      </div>
    </div>
    <div class="view-bottom">
      <button class="primary" id="btn-save" disabled data-i18n="newInstall.addInstallation">Add Installation</button>
    </div>
  </div>

  <!-- Progress View -->
  <div id="view-progress" class="view">
    <div class="toolbar">
      <h2 id="progress-title" data-i18n="progress.working">Working…</h2>
      <div class="toolbar-actions">
        <button class="danger" id="btn-progress-cancel" style="display:none" data-i18n="common.cancel">Cancel</button>
      </div>
    </div>
    <div class="view-scroll" id="progress-content"></div>
  </div>

  <!-- Instance Detail View -->
  <div id="view-detail" class="view">
    <div class="toolbar">
      <h2 id="detail-title"></h2>
      <button id="btn-detail-back" class="back-btn"><svg width="14" height="14"><use href="#icon-arrow-left"/></svg> <span data-i18n="common.back">Back</span></button>
    </div>
    <div class="view-scroll" id="detail-sections"></div>
    <div id="detail-bottom-actions"></div>
  </div>

  <!-- Track Existing View -->
  <div id="view-track" class="view">
    <div class="toolbar">
      <h2 data-i18n="track.title">Track Existing Installation</h2>
      <button id="btn-track-back" class="back-btn"><svg width="14" height="14"><use href="#icon-arrow-left"/></svg> <span data-i18n="common.back">Back</span></button>
    </div>
    <div class="view-scroll">
      <div class="field">
        <label for="track-path" data-i18n="track.installDir">Installation Directory</label>
        <div class="path-input">
          <input type="text" id="track-path" placeholder="Select a directory…" readonly>
          <button id="btn-track-browse" type="button" data-i18n="common.browse">Browse…</button>
        </div>
      </div>

      <div class="field">
        <label for="track-source" data-i18n="track.detectedType">Detected Type</label>
        <select id="track-source" disabled><option>Browse to a directory first</option></select>
      </div>

      <div class="field">
        <label for="track-name" data-i18n="common.name">Name</label>
        <input type="text" id="track-name" placeholder="e.g. ComfyUI Main">
      </div>

      <div id="track-detail"></div>
    </div>
    <div class="view-bottom">
      <button class="primary" id="btn-track-save" disabled data-i18n="track.trackInstallation">Track Installation</button>
    </div>
  </div>

  <!-- Console View -->
  <div id="view-console" class="view">
    <div class="toolbar">
      <h2 id="console-title" data-i18n="console.title">ComfyUI Console</h2>
      <div class="toolbar-actions">
        <button id="btn-console-browser" data-i18n="console.openInBrowser">Open in Browser</button>
        <button class="danger" id="btn-console-stop" data-i18n="console.stop">Stop</button>
      </div>
    </div>
    <div class="terminal-output" id="console-terminal"></div>
  </div>

  <!-- Settings View -->
  <div id="view-settings" class="view">
    <div class="toolbar">
      <h2 data-i18n="settings.title">Settings</h2>
      <button id="btn-settings-back" class="back-btn"><svg width="14" height="14"><use href="#icon-arrow-left"/></svg> <span data-i18n="common.back">Back</span></button>
    </div>
    <div class="view-scroll" id="settings-sections"></div>
  </div>

  <script src="renderer/i18n.js"></script>
  <script src="renderer/util.js"></script>
  <script src="renderer/modal.js"></script>
  <script src="renderer/list.js"></script>
  <script src="renderer/detail.js"></script>
  <script src="renderer/new-install.js"></script>
  <script src="renderer/progress.js"></script>
  <script src="renderer/console.js"></script>
  <script src="renderer/settings.js"></script>
  <script src="renderer/track.js"></script>
  <script src="renderer/update-banner.js"></script>
  <script>
    window.api.getLocaleMessages().then((msgs) => window.Launcher.i18n.init(msgs));
    window.api.getResolvedTheme().then((t) => window.Launcher.applyTheme(t));
    window.api.onThemeChanged((t) => window.Launcher.applyTheme(t));
    window.Launcher.detail.init();
    window.Launcher.newInstall.init();
    window.Launcher.settings.init();
    window.Launcher.track.init();
    window.Launcher.updateBanner.init();
    document.getElementById("btn-settings").onclick = () => window.Launcher.settings.show();
    window.Launcher.list.render();
  </script>
</body>
</html>
